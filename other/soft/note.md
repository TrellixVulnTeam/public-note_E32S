# 目录
<!-- TOC -->

- [目录](#目录)
- [一、数据通信基础](#一数据通信基础)
    - [1.1 信道特性](#11-信道特性)
    - [1.2 传输介质](#12-传输介质)
    - [1.3 数据编码](#13-数据编码)
    - [1.4 数字调制技术](#14-数字调制技术)
    - [1.5 脉冲编码调制](#15-脉冲编码调制)
    - [1.6 通信方式](#16-通信方式)
    - [1.7 交换方式](#17-交换方式)
    - [1.8 多路复用技术](#18-多路复用技术)
    - [1.9 差错控制](#19-差错控制)
- [二、广域通信网](#二广域通信网)
    - [2.1 公共交换电话网(PSTN)](#21-公共交换电话网pstn)
    - [2.2 X.25公用数据网](#22-x25公用数据网)
        - [1) 流量控制](#1-流量控制)
        - [2) 差错控制](#2-差错控制)
        - [3) HDLC](#3-hdlc)
        - [4) PLP](#4-plp)
    - [2.3 帧中继(FRN)](#23-帧中继frn)
    - [2.4 ISDN](#24-isdn)
    - [2.5 ATM](#25-atm)
    - [2.6 其他](#26-其他)
- [九、组网技术](#九组网技术)
    - [9.1 交换机基础](#91-交换机基础)
    - [9.2 路由器基础](#92-路由器基础)
    - [9.3 【重要】访问控制表(ACL)](#93-重要访问控制表acl)
    - [9.4 交换机和路由器配置](#94-交换机和路由器配置)

<!-- /TOC -->

# 一、数据通信基础
## 1.1 信道特性
* 信道带宽
    * 模拟信道带宽: `W = f2 - f1`
        * f1是信道能通过的最低频率, f2是信道能通过的最高频率, 由物理特性决定
    * 数字信道带宽
        * 码元, 一个数字脉冲, 也可以理解为一个符号
        * 码元速率(波特率), 单位时间内信号变换的次数, 也可以理解为传输符号的个数: `B = 1 / T`
            * B为波特率, T为单个码元传输时间
            * 对于无噪声的模拟信道带宽为W， 奈奎斯特定理表明，极限波特率为: `B = 2*W`
        * 【重要】数据速率(比特率): `R = B * log2(N)`, 因此无噪信道的极限比特率为 `R = 2 * W * log2(N)`
            * N为码元种类数, 如3bit的码元种类数为8
            * 已知信道带宽，可以知道极限波特率，如果知道目标数据速率(有可能是信道容量)，可以进一步求的N
        * 【重要】有噪声的信道极限数据速率(香浓定理)为: `C = W * log2(1 + S / N)`
            * S/N 为信噪比, db = 10*log10(S/N)
        * 数字信道的带宽就是 信道能达到的最大数据速率。
* 误码率: `Pc = Ne / N`
    * Ne为出错的位数, N为传送的总位数。
    * 计算机网络要求Pc < 10^(-6), 1Mb最多只能错一个。
* 信道延迟, 从信源到信宿需要的时间。

## 1.2 传输介质
* 双绞线, 通常一根民用网线中有多根双绞线。
* 同轴电缆
* 光纤
* 无线信道

## 1.3 数据编码
* 单极性码, 只用正的(或负的)的表示0，0V表示1。抗噪性能差，需要时钟信号配合定时
* 极性码, 用正负电压分别表示0和1。抗噪性能好，需时钟信号配合定时。
* 双极性码, 信号在正负零之间变化。
    * AMI, 一种双极性码, 遇到1使信号正负交替, 遇到0则保持零电平。
* 归零码, 码元中间的信号回归到零电平。自定时，抗干扰好。
* 双相码，每一位码元都要有一个信号翻转。自定时，检错。
    * 曼彻斯特编码， 1->0表示0, 0->1表示1
    * 差分曼彻斯特编码
* 不归零码，1出现翻转电平，0出现不翻转电平。
* 【重要】4B/5B编码，使用曼彻斯特编码和差分曼彻斯特编码会导致每bit都要跳变，因此带宽会是数据速率的两倍，成本太高。
    * 先进行4B/5B译码 然后再通过NRZ编码。

## 1.4 数字调制技术
* 调幅(ASK), 将0和1调制为不同幅度，但是频率相同的载波。
* 调频(FSK), 将0和1条职位不同频率，但是幅度相同的载波。
* 跳相(PSK), 利用相邻载波信号的香味来表示数据的信息，频率和幅度不变。
    * DPSK 相位不变为1 反相位为0
* 正交调幅(QAM), 对正弦波和余弦波进行数字调幅, 相加后进行传输。是ASK和PSK的结合使用。
    * 【重要】该书涉及的QAM通常是16QAM，即一个码元有16个符号，数据速率是波特率的4倍。

## 1.5 脉冲编码调制
* 采样
    * 【重要】根据奈奎斯特采样定理，采样速率必须大于模拟信号最高频率的两倍。否则无法恢复原来的模拟信号。
* 量化
* 编码

## 1.6 通信方式
【重要】主要是要一些计算方法:
* 电磁波速率: 200km/ms
* 传播时延: 距离/电磁波速率
* 对于同步方式
    * 每帧有一应一答两个包，每个包都有传播时延。
    * N帧有2N个包，有2N * 单个包传播时延。
    * N帧有N * 单位帧bit的数据量，传输耗时为N * 单位帧耗时/速率。


## 1.7 交换方式
* 电路交换, 用物理线路吧发送方和接收方直接连通。3个阶段:
    * 1) 建立线路
    * 2) 数据传输
    * 3) 释放线路
    * 独占性强，实时性好，适合于大量数据传输。
* 报文交换(存储转发交换), 不要求通信节点之间建立专用线路，报文中包含目标地址，完整的报文在网络中进行传送。
    * 每个中间节点接受完整的报文
    * 解析报文目标地址，进行转发
    * 缺点是通信可能有延时。
* 分组交换, 类似报文交换，但是限制了报文的长度.节点会对数据进行分组病编号，每个分组都有原地址和目标地址。
    * 数据包，类似报文交换，每个分组都有完整的地址信息。可能存在重排序和丢包问题。
    * 虚电路，类似电路交换，发送端和接收端建立逻辑连接。发送端发出的分组都走这一条通路。其实就是先建立会话，会话建立后中间节点的转发就已经确定了，一个包一个包的传，效率较低。

## 1.8 多路复用技术
* 【重要】数字传输系统
    * T1，24路时分多路的方式符合在一条1.544Mb/s的总信道，每一路的传输速率是56Kb/s
    * E1，总速率为2.048Mb/s，子信道速率为64Kb/s，有32个子信道
    * E2，4个E1。E3、E4同理。
 
## 1.9 差错控制
* 奇偶校验
    * 水平奇偶校验，7bit的ASCII后增加1bit，使码字中1的个数变成奇数或偶数。
    * 垂直奇偶校验，将传输的信息分组，分为若干行列。组中每个字符相同位进行奇偶校验，最终产生一批奇偶校验字符，附加在分组信息之后。
    * 水平垂直奇偶校验，实在水平校验的基础上实施垂直校验，保证最后一位的正确性。
* 海明码
    * 【重要】海明距，一个码字改变成另一个码字的最小位数。
    * 如果海明距为d，则所有小于等于d-1位的错误都可以检查出来，所有小于d/2的错误都可以修正。
    * 【重要】单bit海明码纠错下限：`2^k > k + m + 1`
        * k为校验位数，m为信息位数
* CRC

# 二、广域通信网
## 2.1 公共交换电话网(PSTN)
* 组成部分:
    * 本地回路, 采用模拟传输
    * 干线, 采用数字传输
    * 交换机, 采用数字传输
* 本地回路是模拟的，因此需要把数字信号转为模拟信号。干线和交换机是数字的，因此传输到端局后，需要把模拟信号转换为数字信号。效率较低。

## 2.2 X.25公用数据网
X.25是以分组方式进行工作的DTE(终端)和DCE(调制解调器)接口，是【分组交换技术】。X.25包含了物理层、链路层和分组层的协议。
* 物理层协议: X.21, 定义主机与物理网络之间的电气特性。
* 链路层协议: LAP-B, 进行可靠数据传输。包括帧格式定义和差错控制。是HDLC的一部分(高级数据链路控制协议)
* 分组层协议: PLP, 描述主机与网络之间的相互作用。分组定义、寻址、流量控制以及拥塞控制。运行用户建立虚电路。

### 1) 流量控制
流量控制用于让发送节点感知到接收节点的处理速度，以此控制发送速度，避免接收节点处理速度过慢，缓冲区溢出，后续的数据被丢掉。
* 停等协议
    * 发送出一帧，等待应答信号(ACK)后才发送下一帧。线路利用率为: `E = Tf / (2Tp + Tf)`
    * E为线路利用率, Tf为发送一帧的时间, Tp为一个包的传播延迟。
* 滑动窗口协议
    * 停等协议效率较低，滑动窗口运行连续多针而无须等待应答。
    * 每个帧都会进行编号，以控制后续传输。
    * 若窗口大小为W，接收节点响应i，发送端会将发送窗口设置为(i, i+W]，W为接收节点告诉发送端的。

### 2) 差错控制
* 停等ARQ
    * 停等流控和自动重发结合，发送一帧后必须等待应道，收到应答信号ACK后发送下一阵，收到否定应答NAK重发该镇。ACK超时也会进行重发。
* 选择重发ARQ
    * 窗口流控和自动重发的结合。接收节点会响应窗口中哪个帧失败了，正确的帧会被缓存。
* 回退N帧ARQ
    * 窗口流控和自动重发的结合。接收节点响应窗口中第q帧丢失了，则[q, m]的帧都会重发。

### 3) HDLC
Ciscio路由器同步串口默认采用HDLC协议。

### 4) PLP
* 支持虚电路
    * 交换虚电路(SVC), 向网络发送请求建立连接的报文，虚电路一旦建立，可以保证数据正确达到接收方。建立耗时。
    * 永久虚电路(PVC), 用户预先租用，无需建立耗时。
* PLP协议
    * 将数据分成128字节大小的块，再加上24bit或32bit的分组头。

## 2.3 帧中继(FRN)
X.25的进化，也是【分组交换技术】，工作在网络模型的物理层和链路层。帧中继在链路层建立虚电路。

## 2.4 ISDN
综合业务数字网, 是【数字交换电话系统】。
* 窄带ISDN(N-ISDN) 把视频、音频和数据业务在一个网络上传输。
    * 提供基本速率2B+D和一次群速率30B+D。B是64Kb/s的语音数据信道, D是16Kb/s的信令信道。 
    * 小型用户通过NT1将挂接8台设备共享2B+D的信道(144Kb/s)
    * 大型企业通过NT2将挂接8台设备共享30B+D的信道(2.048Mb/s)
* 传输模式
    * 同步传输模式(STM)，时分多路服用，不同的子信道通过帧内时间片进行区分，每个子信道周期性占用帧中的固定时间片。
    * 异步传输模式(ATM)

## 2.5 ATM

## 2.6 其他
* PPP(点对点协议)协议工作于数据链路层,  包含LCP和NCP协议。LCP负责链路建立，NCP负责网络层协议的协商。
* DSL(数字用户线路), 允许用户在传统电话线上提供高速的数据传输。
    * ADSL, 非对称DSL, 上下行流量不对称。需要安装PPPoE，并通过ADSL Model连接到电话入户接线盒。一般具有3个信道，划分方式为频分复用：
        * 1.544-9Mb/s的高速下行信道
        * 16-640Kb/s的双攻信道
        * 64Kb/s的语音信道
    * SDSL, 对称DSL，上下行流量对称，最高可达到1.544Mb/s
    * ISDNDSL, 介于IDSN和DSL之间
    * HDSL, 高比特率DSL
    * VDSL, 甚高比特率DSL
* HFC，将光缆敷设到小区，然后通过光电转换节点，利用有线电视CATV的总显示同轴电缆连接到用户。
    * 用户端需要Cable Model。
    * 局端用于控制和管理用户的设备为CMTS，可以管理和控制Cable Model。

# 九、组网技术

## 9.1 交换机基础
* 交换机作用
    * 通常我们指的交换机是二层交换机, 随着科技发展, 目前也有三层、四层交换机。
    * 基于MAC地址识别来实现数据帧转发功能的网络连接设备。根据近日端口数据帧中的MAC地址进行过滤和转发。
* 工作方式
    * 存储方式, 存储帧到交换机中，并进校校验再做转发, 速度较慢。
    * 快速转发, 只检查数据帧目的地址，速度快，但是有错误帧。
    * 碎片丢弃，只检查是否为冲突碎片，如果不是直接转发。
* 工作原理
    * 交换机初始交换表为空，通过学习的方式建立MAC地址到交换机端口的映射。
    * 交换表的建立方式为通过发送方来获取。当A的数据通过P1端口到交换机，交换表中就会有A_MAC-->P1记录。
    * 数据包发往B时，查询交换表，找到对应的B_MAC所对应的端口P2，进行转发。
    * 若B_MAC不存在，则向所有的非P1端口广播。
* 默认情况下交换机所用端口属于同一VLAN。不同VLAN之间通信需要三层设备。

## 9.2 路由器基础
路由器工作在OSI的第三层(网络层)，根据接收到的数据包中的网络层目的地址以及路由器维护的路由表决定下一跳的地址。路由器可以和网络上的其他路由器交换路由和链路信息来维护路由表。
* 路由器端口:
    * 【重要】RJ-45, 通过双绞线连接以太网。
    * AUI端口, 用在令牌环网和总线型以太网中。
    * 高速同步串口(Serial), 用于连接DDN、帧中继、X.25和PSTN等网络。
    * ISDN BRI, 通过ISDN线路实现路由器和Internet其他网络连接。
    * 异步串口, 主要用于Modem和Modem池的连接。
    * Console端口，通过配置专用电缆连接至计算机串行口。
    * AUX端口，在远处配置时使用。
* 路由器转发过程：
    * 主机将分组发给默认路由，默认路由收到分组之后，根据分组中的目的地址查询路由表
    * 路由表支出该分组的传输路径，路由器知道该分组的下一跳路由器IP地址
    * 通过ARP得到下一跳IP对应的MAC地址，替换数据分组中的MAC地址，转发给下一跳路由器。
* 路由表：
    * 路由源码 目的地址 掩码 下一跳路由器地址
    * 第一列为路由源码
        * S : 静态路由
        * C : 直连
        * O : OSPF获得路由信息

## 9.3 【重要】访问控制表(ACL)
ACL是属于路由器中的配置，提供了基于源地址、目的地址、各种协议和端口号的过滤准则。
* 标准访问控制列表
    * 只针对数据包中的【源地址】进行检查，表号为1~99 和 1300~1999。
* 扩展访问控制列表
    * 检查源地址、目的地址、协议。表号为100~199 和 2000~2699。
* 匹配顺序从上至下，特殊的放在前，通用的放在后。所谓的从上至下指的是以rule-id为顺序。
* 接近数据源地址的路由器应该使用`扩展访问控制`，接近目的地址的路由器应该使用`标准访问控制`

## 9.4 交换机和路由器配置
* 华为配置视图状态
    * `<switch>`, 交换机路由器正常启动。用户用Telnet登录后自动进入用户视图模式。用户可以查看链接状态，访问其他网络和主机，但是不能更改路由器设置。
    * `[switch]`, 系统视图命令状态。在用户视图下输入`system-view`进入。
    * `[switch-bussines]`, 业务视图状态。在switch输入需要配置的业务命令后进入，通过`quit`退出到系统视图。
* Cisco交换机/路由器提示符模式(思科的直接放弃吧)
    * `>`, 用户模式。在Cisco设备启动工作完成后，进入用户模式。只允许基本检测命令。
    * `#`, 特权模式。在用户模式下输入enable, 可以查看状态，但是不能配置。
    * `(config)#`, 全局模式。在特权模式下输入config terminal进入全局模式。通过全局模式还可以进入单个接口进行单独的配置
    * `(config-if)#`, 在单个接口中进行配置。在全剧模式下输入命令可以进入，如interface fastethernet0/1。通过`exit`可以退出到全局模式。
* 用户密码相关配置
    * pass
* 常见的配置
    * `<huawei>system-view`, 进入系统命令视图
    * `[huawei]sysname R1`, 配置设备名从huawei--->R1
    * `[R1]user-interface console 0`, 进入console业务界面视图，console编号只能为0
    * `[R1-ui-console0] quit`, 退出到系统命令视图.
    * `[R1]acl 2000` , 定义ACL。
    * `[R1-acl-2000] rule 5 permit source <ip> <nmask>`，添加ACL匹配规则。
    * `[R1]interface GigabiEthernet 0/0/1`, 进入接口的配置视图。
    * `[R1-GigabitEthernet 0/0/1] ip address <address> <mask>`, 配置路由器接口的ip地址。
    * `[R1] nat address-group 1 <start-ip> <end-ip>`, 配置nat的出口ip范围(nat ip池)。
    * `[R1-GigabitEthernet 0/0/1] nat bound 2000 address-group1`, 把GigabitEthernet 0/0/1的ACL2000配置与ip地址1关联。
    * `[Router-GigabitEthernet 1/0/0]ip route-static 0.0.0.0 <next-ip>`, 配置默认路由。
    * `[switch-ge 0/0/2] port link-type `
    * `[switch-ge 0/0/2] ip address <ip> <mask>`, 配置端口的ip地址和掩码。
    * `[switch]dhcp enable`, 开启dhcp
    * `[switch]ip pool pooll`
    * `[switch-ip-pool-pooll]lesae day <day>`, dhcp的ip租期。
